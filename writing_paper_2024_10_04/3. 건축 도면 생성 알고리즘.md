### 3.1 방 배치 알고리즘 (Room Placement Algorithm)

건축배치 공간 $G_{footprint}$는 $m\times{n}$ 크기의 격자에, 방배치가 가능한 내부 공간으로 다음과 같이 정의한다. 
 $$G_{footprint}​=\{(i, j)|g_{ij}​ = 1\}\tag{1}$$
 1. $G_{footprint}$에서 공간의 개수 $k$ 만큼 임의의 위치을 선택한다.  여기서는 이를 시드 셀 혹은 시작 셀로 명명한다. 
 2. 시드 셀에 고유한 방 번호를 할당한다. 방 번호 할당은 임의로, 미리 정의한 인접성 요구사항과 방향 요구사항을 적용/미적용한다.  각 선택된 셀 $s_i \in S$는 서로 다른 방 번호를 갖는다.  각 방의 시드 셀은  개별 공간의 형태와 크기, 위치, 그리고 방 상호간의 인접 관계를  결정하는 데 중요한 역할을 한다. 

$$G_{\text{init}} = \{g_{ij} \mid g_{ij} \in \{1, 2, \ldots, k\}, (i, j) \in S \}\tag{2} $$

여기서 $S$는 $k$개의 임의의 셀로 구성된 집합으로, $S$의 각 요소는 서로 다른 방 번호를 가지며, 그리드의 나머지 부분은 아직 할당되지 않았다. 


#### 3.2.1.2 방향 요구사항에 최적화된 시작 셀 배치

선택된 $k$개의 셀은 공간 확장의 시작 셀이므로 $k$개의 셀 $g_{ij}$ 위치에 따라 건축 배치 내 개별 공간의  방향(orientation)을 결정하게 된다. 따라서 초기 셀이 공간의 방향 요구사항을 만족하도록 $G_{init}$ 내의 다른 셀들과 교환하는 과정을 거쳐 재배치한다. 방향 요구사항은 각이 배치 공간 내에서  동서남북 어느 쪽에 위치하고자 하는지를 지정하며 방과 동서남북 방향 쌍으로 구성된다. 시작 셀 집합 $S$에서 각각 동서남북 방향의 최극단 위치를 구하고, 선택된 시작 셀 $g_{ij}$의 위치가 방향 요구사항이 지시하는 방향과 일치하는지 반복적으로 비교하여 조정한다.

성능 영향
- 각 셀이 방향 요구사항을 만족하는지 확인하고, 만족하지 않을 경우 위치를 교환하는 단계는 각 셀마다 최대 $k$번의 비교 연산이 필요하므로  최악의 경우 $O(k^2)$의 시간이 소요되고, 요구사항을 만족할 때까지 반복하는 과정은 k개의 셀이 모두 재배치될 때까지 반복되며,  각 셀이 한 번 교환될 때마다 최소한 하나의 방향 요구사항이 만족되므로, 반복 횟수는 $k$에 비례한다. 시드셀 위치 재조정 단계에서의 시간 복잡도는 $O(k^2)$이다. 그러나 일반적으로 건축 설계에서는 방의 수가 한정적이고, 각 방의 방향 요구사항이 명확히 정의되어 있으므로 알고리즘이 최적화된 형태로 동작하여, 시드 셀의 위치를 빠르게 재조정되며 추가적인 성능 낭비 없이 방향 요구사항을 초기에 조정할 수 있다. 
방 배치의 초기 작업은 주어진$m \times n$크기의 격자 배열에서 내부 공간으로 정의된 각 셀에 대해$k$개의 시작셀을 선택하는 것이다. 이 때 시작 셀은 다음 조건을 만족한다:

1. 각 방은 플로어플랜 내에서 비어 있는 셀에 배치되어야 한다.
2. 같은 셀에 두 개 이상의 방이 배치될 수 없다.

이것은 무작위 함수$R$을 이용하여,$k$개의 방이 모두 배치될 매 반복마다 방을 배치할 셀의 좌표$(i, j)$를 선택한다. 이때$R$은 값이 1인 셀들의 집합에서 무작위로 선택된다. 배치할 셀이 이미 점유된 경우, 새로운 무작위 좌표가 선택되며, 이 과정은  때까지 반복된다.


1. **셀 선택의 경우의 수**:$N$개의 셀 중에서$k$개의 셀을 선택하는 경우의 수는 조합으로, 다음과 같다:

$$
\binom{N}{k} = \frac{N!}{k! \times (N - k)!}
$$

2. **방 번호 할당의 경우의 수**: 선택된$k$개의 셀에 서로 다른 방 번호를 할당하는 경우의 수는$k$개의 셀에 대한 순열로, k! 로 계산된다. 

따라서,  주어진 격자 공간 내에 초기 방 위치를 결정하는 모든 경우의 수는 이 두 가지 경우의 수를 곱해 다음과 같이 계산된다. 

$$
\text{총 경우의 수} = \binom{N}{k} \times k! = \frac{N!}{(N - k)!}
$$

기본 공간의 크기가$1m^2$으로 이루어진$128m^2$의  현실적인 크기의 주택의 경우 8 개의 방 배치를 위한 시작셀의 선택 방법의 모든 가지수는 총 5.765e+16 으로 57경 단위의 매우 큰 수가 된다.

---

### 3.2 시작 위치의 방향 요구사항 최적화 (Optimization of Initial Cell Placement for Adjacency Requirements)

 무작위로 선택된 개별 방의 시작 위치는 각방의 인접관계 및 방향을 결정하는데 큰 영향을 끼치게 된다. 따라서 선택된 공간의 방향(예: 북쪽, 남쪽, 동쪽, 서쪽)에 위치할 수 있도록 다음 방법으로 셀의 위치를 교환한다. 

1. **방향별 극단 위치 식별**:
   - 각 방의 시작 위치를 분석하여, 최북단, 최남단, 최서단, 최동단에 위치한 방들의 시작 위치 리스트를 생성한다. 

2. **방향 요구사항 확인 및 조정**:
   - 각 방에 대해 사전에 정의된 방향 요구사항을 확인한다. 예를 들어, 방 B는 남쪽에 위치해야 한다는 요구가 있을 수 있다.  방 B가 현재 최남단 리스트에 포함되지 않은 경우, 최남단 리스트에 있는 다른 방들과 위치를 교환하여 방 B를 남쪽으로 이동시킨다.
 방이 요구되는 방향에 최대한 맞추어 위치하도록 조정하여, 전체적인 설계 목표를 충족시키는 데 도움을 준다. 이를 통해 플로어플랜 설계에서 방향 요구사항을 효과적으로 반영할 수 있으며, 특히 기능적 요구사항에 따라 방 배치가 적절하게 이루어지도록 한다.

이 방법은 건축 설계 초기 단계에서 방향 제약을 반영한 공간 배치를 생성하는 데 중요한 역할을 하며, 설계 품질을 높이는 데 기여한다.