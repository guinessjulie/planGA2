### 4. 공간 배치 평가 방법

이 섹션은 생성된 공간 배치를 평가하기 위한 평가 방법을 제시한다. 평가 방법은 사용자가 요구한 세 가지 주요 요구사항(인접성, 면적, 방향성)에 대한 만족도 평가와 각 방의 기하학적 형태에 대한  정량적으로 평가 방법으로 크게 나누어진다.  이를 이용하여 각 요구사항에 대한 가중치를 반영한 통합 적합성을 평가 방법을 제공함으로써, 사용자의 설계 목표에 맞춘 최적화된 공간 배치를 찾을 수 있도록 해준다. 

#### 4.1 세 가지 주요 요구사항의 적합도 계산

설계 평가의 핵심 요소는 인접성, 면적, 방향성의 적합도를 기반으로 이루어진다. 각 요구사항의 적합도는 독립적으로 평가되며, 세부 계산 방법은 다음과 같다.

##### 4.1.1 인접성 만족도 (Adjacency Satisfaction)
인접성 만족도는 요구된 방들 간의 인접 관계가 얼마나 충족되는지를 평가하는 척도로 정의된다. 각 방 쌍 i와 j에 대해, 인접 요구사항 Rij∈{0,1} 및 실제 인접 관계 Aij∈{0,1}를 사용하여 만족도를 계산한다. 여기서 Rij=1은 방 i와 j 사이에 인접 요구가 존재함을 의미하며, Aij=1은 두 방이 실제로 인접함을 의미한다. 인접성 만족도는 요구된 인접성을 가진 방 쌍에 대해서만 평가되며, 모든 방 쌍을 고려하지 않는다. 평가 과정은 다음과 같은 단계로 이루어진다.
１。 요구된 방의 인접성 평가 
공간 배치의 각 방에 대한 인접성은 너비 우선 탐색(BFS) 방식을 사용하여 계산된다. 구체적으로, 주어진 평면도 FFF의 모든 셀을 순회하며 해당 방의 인접 셀을 기반으로 방들 간의 인접 리스트를 생성한다. BFS 알고리즘은 셀 cic_ici​를 기준으로 상, 하, 좌, 우의 이웃 셀 adj(ci)\text{adj}(c_i)adj(ci​)의 방 번호 R(adj(ci))R(\text{adj}(c_i))R(adj(ci​))를 확인하여, 방 R(ci)R(c_i)R(ci​)와 이웃 방 R(adj(ci))R(\text{adj}(c_i))R(adj(ci​))의 인접 관계를 기록한다. 이미 탐색된 셀들은 중복 처리를 방지하기 위해 기록되며, 각 방의 인접 관계는 BFS 탐색이 완료된 후 adj_list\text{adj\_list}adj_list에 저장된다.
1. **요구된 방 쌍의 인접성 평가**: 
인접성을 평가하는 방식에 대한 설명이 빠졌다는 점을 고려하여, 코드를 기반으로 한 인접성 평가 부분을 추가하겠다. 해당 코드는 주어진 평면도에서 각 방 간의 인접 관계를 계산하며, 이를 기반으로 방들의 인접성을 평가한다. 이 과정에서 방의 셀(cell) 단위로 인접성을 판단하며, 너비 우선 탐색(BFS)을 사용하여 인접 리스트(adjacency list)를 생성하는 방식으로 동작한다.

### 수정된 본문: 인접성 만족도 (Adjacency Satisfaction)

4.1.1 인접성 만족도 (Adjacency Satisfaction)

인접성 만족도는 요구된 방들 간의 인접 관계가 얼마나 충족되는지를 평가하는 척도로 정의된다. 각 방 쌍 i와 j에 대해, 인접 요구사항 Rqij∈{0,1} 및 실제 인접 관계 Acij∈{0,1}를 사용하여 만족도를 계산한다. 여기서 Rqij=1은 방 i와 j 사이에 인접 요구가 존재함을 의미하며, Acij=1은 두 방이 실제로 인접함을 의미한다. 인접성 만족도는 요구된 인접성을 가진 방 쌍에 대해서만 평가되며, 모든 방 쌍을 고려하지 않는다. 평가 과정은 다음과 같은 단계로 이루어진다.

#### 1. 인접성 평가 방법

공간 배치의 각 방에 대한 인접성은 너비 우선 탐색(BFS) 방식을 사용하여 계산된다. 구체적으로, 주어진 평면도 \( F \)의 모든 셀을 순회하며 해당 방의 인접 셀을 기반으로 방들 간의 인접 리스트를 생성한다. BFS 알고리즘은 셀 \( c_i \)를 기준으로 상, 하, 좌, 우의 이웃 셀 \( \text{adj}(c_i) \)의 방 번호 \( R(\text{adj}(c_i)) \)를 확인하여, 방 \( R(c_i) \)와 이웃 방 \( R(\text{adj}(c_i)) \)의 인접 관계를 기록한다. 이미 탐색된 셀들은 중복 처리를 방지하기 위해 기록되며, 각 방의 인접 관계는 BFS 탐색이 완료된 후 인접된 두 방 번호 쌍으로 구성된 인접 리스트 집합 \( AL \)에 저장된다.
1. 인접성 평가 방법

공간 배치의 각 방에 대한 인접성은 너비 우선 탐색(BFS) 방식을 사용하여 계산된다. 구체적으로, 주어진 평면도 F의 모든 셀을 순회하며 해당 방의 인접 셀을 기반으로 방들 간의 인접 리스트를 생성한다. BFS 알고리즘은 셀 ci​를 기준으로 상, 하, 좌, 우의 이웃 셀 adj(ci)의 방 번호 R(adj(ci))를 확인하여, 방 R(ci)) 와 이웃 방 R(adj(ci))의 인접 관계를 기록한다. 이미 탐색된 셀들은 중복 처리를 방지하기 위해 기록되며, 각 방의 인접 관계는 BFS 탐색이 완료된 후 인접된 두 방 번호 쌍으로 구성된 인접 리스트 집합 AL에 저장된다.
#### 2. 인접성 평가

요구된 방 쌍 \( (R_{q_{ij}} = 1) \)에 대해 실제 인접 여부 \( A_{c_{ij}} = 1 \)을 확인한다. 만족된 요구사항의 개수 \( S_{\text{adj}} \)는 요구된 방 쌍 \( R_{q_{ij}} = 1 \)의 개수 중 실제 인접 리스트에 존재하는 \( A_{c_{ij}} = 1 \)인 경우의 수로 계산된다. 인접성 만족도 \( AS \)는 다음 수식으로 정의된다:

요구된 방 쌍 (Rqij=1) i, j에 대해 실제 인접 여부 Acij=를 확인한다. 만족된 요구사항의 개수 Satadj는 요구된 방 쌍 Rqij=1의 개수 중 실제 인접 리스트에 존재하는 Acij=1인 개수 비율로 계산한다.
\[
\text{AS} = \frac{S_{\text{adj}}}{T_{\text{adj}}}
\]
여기서 \( S_{\text{adj}} \)는 만족된 인접 요구사항의 총 개수, \( T_{\text{adj}} \)는 요구된 인접 요구사항의 총 개수이다.




2. 인접성 평가

요구된 방 쌍 (Rqij=1) i, j에 대해 실제 인접 여부 Acij=를 확인한다. 만족된 요구사항의 개수 Satadj는 요구된 방 쌍 Rqij=1의 개수 중 실제 인접 리스트에 존재하는 Acij=1인 개수 비율로 계산한다.

\[
\text{AS} = \frac{S_{\text{adj}}}{T_{\text{adj}}}
\]

－－－

인접성 만족도는 주어진 공간 배치에서 특정 방들 간의 인접 요구사항이 얼마나 충족되었는지를 평가하는 척도로 정의된다. 각 방 쌍 \( i \)와 \( j \)에 대해 인접 요구사항 \( R_{ij} \in \{0, 1\} \) 및 실제 인접 관계 \( A_{ij} \in \{0, 1\} \)을 사용하여 만족도를 계산한다. 여기서, \( R_{ij} = 1 \)은 방 \( i \)와 \( j \) 간에 인접 요구가 존재함을 의미하며, \( A_{ij} = 1 \)은 두 방이 실제로 인접함을 의미한다.

인접성 만족도는 요구된 인접성을 가진 방 쌍에 대해서만 평가되며, 모든 방 쌍을 고려하지 않는다. 이 방식은 비필요한 계산을 줄이고, 실제 요구된 인접 관계에 초점을 맞춰 만족도를 효율적으로 산출한다. 평가 과정은 다음과 같은 단계로 이루어진다.

#### 1. 인접성 평가 과정

공간 배치의 각 방에 대한 인접성은 **너비 우선 탐색**(BFS) 방식을 사용하여 계산된다. 구체적으로, 주어진 평면도(floorplan)를 순회하며 각 방의 인접 셀(cell)을 확인하고, 그 결과를 기반으로 방들 간의 인접 리스트(adjacency list)를 생성한다. 이 인접 리스트는 각 방이 인접한 다른 방들의 집합으로 구성된다.

- **BFS 알고리즘**은 각 방의 셀을 기준으로 시작되며, 4방향(상, 하, 좌, 우)으로 탐색을 수행한다.
- 동일한 방에 속하는 셀들은 하나의 방으로 처리되며, 인접한 다른 방의 셀을 발견할 경우, 해당 방을 인접 리스트에 추가한다.
- 방 번호가 -1인 경우, 이는 빈 공간이나 벽을 의미하며 탐색에서 제외된다.
- 탐색된 셀들은 중복 처리를 방지하기 위해 `visited` 배열에 기록되며, 각 방의 인접 관계는 BFS 탐색이 완료된 후 `adj_list`에 저장된다.

#### 2. 요구된 방 쌍의 인접성 평가

인접 리스트가 생성된 후, 요구된 방 쌍 \( (i, j) \)에 대해 실제 인접 여부를 평가한다. 각 방 쌍 \( (i, j) \)가 실제로 인접한 경우, \( A_{ij} = 1 \)로 정의되며, 이는 코드에서 `if room2 in adj_list[room1]` 조건으로 평가된다. 이 과정은 요구된 인접성을 가진 방 쌍에 대해서만 수행된다.

#### 3. 만족된 인접 요구사항의 개수 \( S_{\text{adj}} \)

만족된 인접 요구사항의 개수 \( S_{\text{adj}} \)는 요구된 방 쌍 중 실제로 인접한 방 쌍의 개수로 정의된다. 즉, 방 \( i \)와 \( j \) 사이의 인접 요구사항이 존재하고 \( A_{ij} = 1 \)인 경우에만 만족된 요구사항으로 간주하여 점수를 누적한다. 이는 코드에서 요구된 방 쌍을 순회하며 인접 리스트를 확인하는 방식으로 계산된다.

#### 4. 총 요구된 인접성의 개수 \( T_{\text{adj}} \)

총 요구된 인접 요구사항의 개수 \( T_{\text{adj}} \)는 인접 요구사항이 존재하는 방 쌍의 총 개수로 정의된다. 이는 요구된 인접성 \( R_{ij} = 1 \)인 모든 방 쌍을 포함한다.

#### 5. 인접성 만족도 \( \text{AS} \)

인접성 만족도 \( \text{AS} \)는 만족된 인접 요구사항의 개수와 총 요구된 인접 요구사항의 비율로 정의된다. 즉, 인접성 만족도는 다음과 같은 수식으로 표현된다:
\[
\text{AS} = \frac{S_{\text{adj}}}{T_{\text{adj}}}
\]
여기서 \( S_{\text{adj}} \)는 만족된 인접 요구사항의 총 개수, \( T_{\text{adj}} \)는 요구된 인접성의 총 개수이다. 만일 요구된 인접성이 존재하지 않는 경우, 만족도는 0으로 정의된다.

이와 같은 방식으로 인접성 만족도는 요구된 방 쌍에 대해서만 평가되므로, 공간 배치 상에서 불필요한 계산을 피하면서도 인접 요구사항의 충족도를 정확하게 측정할 수 있다.
3. 각 방 쌍 (i,j)(i, j)(i,j)에 대해, 인접 요구사항 Rij=1R_{ij} = 1Rij​=1인 경우만 인접성을 평가한다. 즉, 두 방 간의 인접 요구가 존재할 때, 실제로 두 방이 인접한지 여부를 확인한다. 이때, Aij=1A_{ij} = 1Aij​=1인 경우 해당 요구사항이 충족된 것으로 간주한다.
    
2. **만족된 인접 요구사항의 개수 SadjS_{\text{adj}}Sadj​**: 요구된 방 쌍 (i,j)(i, j)(i,j) 중 실제로 인접한 방 쌍의 개수로 정의된다. 이는 Aij=1A_{ij} = 1Aij​=1인 경우에 해당하며, 이를 통해 만족된 요구사항의 총 개수를 누적한다. 코드에서는 각 요구된 방 쌍에 대해 실제 인접 여부를 조건문으로 확인하고, 만족된 경우에 점수를 1씩 증가시킨다.
    
3. **총 요구된 인접성의 개수 TadjT_{\text{adj}}Tadj​**: 요구된 인접 관계가 존재하는 방 쌍의 총 개수로 정의된다. 이는 인접 요구사항 Rij=1R_{ij} = 1Rij​=1인 모든 방 쌍의 개수에 해당하며, 코드에서는 요구된 방 쌍의 총 수를 단순히 카운트한다.
    
4. **인접성 만족도 AS\text{AS}AS**: 만족된 인접 요구사항의 개수와 총 요구된 인접성의 개수 간의 비율로 정의된다. 즉, 인접성 만족도는 다음과 같은 수식으로 표현된다:
    
    AS=SadjTadj\text{AS} = \frac{S_{\text{adj}}}{T_{\text{adj}}}AS=Tadj​Sadj​​
    
    여기서 SadjS_{\text{adj}}Sadj​는 만족된 인접 요구사항의 총 개수, TadjT_{\text{adj}}Tadj​는 요구된 인접성의 총 개수이다. 만일 요구된 인접성이 존재하지 않는 경우, 만족도는 0으로 정의된다.
---

인접성 만족도는 요구된 방들 간의 인접 관계가 얼마나 충족되는지를 평가하는 지표이다. 이를 구하기 위해 두 방 $i$와 $j$에 대한 인접 요구사항 $R_{ij} \in \{0, 1\}$ (인접요구가 있는 경우  $R_{ij} = 1$,)과 실제 인접 관계  $A_{ij} \in \{0, 1\}$(실제로 인접한 경우 $A_{ij} = 1$로 )로 표현한다. 
이를 이용하여 만족된 인접 요구사항의 개수 $S_{\text{adj}}$​와 총 요구된 인접 요구사항의 개수 $T_{\text{adj}}$​는 다음과 같이 표현할 수 있다. 

$$
S_{\text{adj}} = \sum_{i,j} R_{ij} \cdot A_{ij}
$$
이 수식은 **모든 방 쌍 i,j** 에 대해 다음을 계산한다:

1. 두 방 i와 j 사이에 **인접 요구사항**이 있는지 확인한다 $R_{ij} = 1$
2. 두 방 i와 j가 실제로 **인접해 있는지** 확인한다 $A_{ij} = 1$
3. 두 값 $R_{ij}$​과 $A_{ij}$​를 곱한다. 이때:
    - $R_{ij} \cdot A_{ij} = 1$이면 요구된 인접성이 실제로 만족된 것이므로 **만족된 요구사항**으로 간주한다.
    - R_{ij} \cdot A_{ij} = 0$이면 요구된 인접성이 만족되지 않았거나, 요구 자체가 없음을 의미한다.
4. 이 계산을 모든 방 쌍 i,j에 대해 수행한 후, 이를 모두 더하여 **만족된 인접 요구사항의 총 개수**를 계산한다.

$$
T_{\text{adj}} = \sum_{i,j} R_{ij}
$$
따라서, 인접성 만족도 AS\text{AS}AS는 다음 수식으로 정의된다:

$$
\text{AS} =\frac{S_adj}{T+adj} = \frac{\sum_{i,j} R_{ij} \cdot A_{ij}}{\sum_{i,j} R_{ij}}
$$

##### 4.1.2 면적 만족도 (Size Satisfaction)

면적 만족도는 각 방의 면적이 주어진 최소 및 최대 요구 사항을 얼마나 충족하는지 평가한다. 실제 면적이 요구 범위 내에 있을 때 적합도 점수는 1로 부여되며, , 범위를 벗어날 경우 최솟값보다 작으면 **실제 면적이 최솟값에 얼마나 가까운 지를 반영**하고, 최댓값보다 클 때는 **최댓값에 비해 얼마나 초과했는지를** 반영해 점수를 계산한다.

- 면적이 요구 범위 내에 있을 때:
$$
\text{ScoreSz}_i = 1 \quad \text{if} \quad A_{\text{min}} \leq A_{\text{actual}} \leq A_{\text{max}}
$$
- 면적이 최솟값보다 작을 때:
$$
\text{ScoreSz}_j = \frac{A_{\text{actual}}}{A_{\text{min}}} \quad \text{if} \quad A_{\text{actual}} < A_{\text{min}}
$$
- 면적이 최댓값보다 클 때:
$$
\text{ScoreSz}_i = \frac{A_{\text{max}}}{A_{\text{actual}}} \quad \text{if} \quad A_{\text{actual}} > A_{\text{max}}
$$

최종 면적 만족도는 각 방의 적합도 점수의 단순 평균으로  산출된다.

$$
\text{Size Satisfaction} = \frac{1}{n} \sum_{i=1}^{n} \text{ScoreSz}_i
$$

여기서 $n$은 평가된 방의 총 개수를 의미한다.

##### 4.1.3 방향성 만족도 (Orientation Satisfaction)

방향성 만족도는 각 방이 요구된 방향성(Orientation Requirements)을 충족하는지 평가한다. 방의 실제 경계에 요구된 방향과 일치하는 경계 면이 존재할 경우 점수가 1로 부여되며, 이를 모든 방에 대해 계산한 후 평균을 구하여 최종 만족도를 산출한다。
$$
\text{ScoreOr}_i = 
\begin{cases}
1, & \text{if } D_{\text{req}_i} \in D_{\text{actual}_i} \\
0, & \text{otherwise}
\end{cases}
$$

즉, 요구된 방향 $D_{\text{req}_i}$가 방 $i$의 실제 경계 방향 $D_{\text{actual}_i}$에 포함되어 있으면 $\text{ScoreOr}_i = 1$, 그렇지 않으면 $\text{ScoreOr}_i = 0$ 이다. , 전체 방향성 만족도는 각 방의 적합도 점수 $\text{ScoreOr}_i$의 평균으로 계산된다. 

$$
\text{Orientation Satisfaction} = \frac{1}{n} \sum_{i=1}^{n} \text{ScoreOr}_i
$$

여기서 $n$은 방향 요구가 있는 방의 개수이다.

#### 4.2 적합도의 가중 평균

프로젝트 특성 별 요구사항의 중요도를 반영하기 위해 생성된 공간 배치 결과의 전체 평가는 사용자지정 가중 조화 평균을 사용하여 계산한다. 가중 조화 평균은 각 요소의 중요도에 따라 가중치를 부여하고, 값이 낮은 요소가 전체 평균에 더 큰 영향을 미치도록 계산하는 방식이다. 이 방식은 특정 요구사항의 만족도가 낮을 경우, 그 요구사항이 전체 평가에 더 큰 영향을 주도록 하여 균형 잡힌 설계를 유도한다. 다음과 같은 수식으로 정의된다:

$$
\text{Total Fitness} = \frac{ adj\_w + ori\_w + size\_w }{ \frac{adj\_w}{adj} + \frac{ori\_w}{size} + \frac{size\_w}{ori} }
$$

여기서:
- $adj$는 인접성 만족도,
- $size$는 면적 만족도,
- $ori$는 방향성 만족도,
- $adj\_w$, $size\_w$, $ori\_w$는 각 요구사항에 대해 설정된 가중치이다.

사용자가 설정한 가중치에 따라 특정 요구사항이 전체 피트니스 점수에 미치는 영향을 조정할 수 있다. 이를 통해 설계 목표에 맞춰 다양한 공간 배치 문제에 최적화된 평가를 수행할 수 있다.

### 4.3 공간의 형태에 따른 평가 방법 


개별 공간의 기하학적 형상 평가를 위해 네 가지 주요 적합도 메트릭을 사용하였다. 이를 위해 격자 기반의 방 배치를 다각형(Polygon) 구조로 변환하는 과정을 설명한다. 

### 4.3.1 격자 공간을 다각형 으로 변환

각 방의 형상 평가를 위해서는 2D 격자 기반 공간 배치 평면보다는 다각형 구조가 유리하다.  격자 셀의 집합  구조 보다는 방의 다각형을 형성하는 꼭지점 좌표를 보다 정교한 기하학적 평가가 가능하기 때문이다.  다각형의 형상 정보를 이용하면  직사각형성, 정규성, 단순성 등의 정량적 측정을 정의하기에 유용하다. 또한, 다각형 구조는 건축 모델로 변환을 용이하게 하여 배치도를 시각적으로 표현하거나, 세밀한 조정이 가능하게 한다. 다음은 격자 기반 공간을 다각형 구조로 변환하는 과정을 설명한다.

**1. 셀 꼭지점 좌표 집합 생성**
   각 방을 구성하는 모든 격자 셀에 대해 네 개의 꼭지점 좌표 집합을 생성한다. 이를 통해 방을 구성하는 전체 좌표 집합 $C$를 정의할 수 있다. 각 셀 $r_i$의 네 꼭지점 좌표는 다음과 같다:$$\text{Corners}(r_i) = \left\{ (x_i, y_i), (x_i, y_i + 1), (x_i + 1, y_i + 1), (x_i + 1, y_i) \mid \forall (x_i, y_i) \in r_i \right\}$ 이다. 
$$ 따라서 전체 꼭지점 집합 C는 모든 셀 r_i의 꼭지점 좌표들의 합집합으로 표현된다. 
$$
C = \bigcup_{i=1}^{k} \text{Corners}(r_i)
$$
   **2. 중복 횟수 카운팅 및 경계 결정**
   각 좌표의  중복 횟수를 카운팅하여 좌표와 중복 횟수의 쌍으로 구성된 집합 Q를 생성한다.  
$$
Q = \left\{ \left( c, \text{count}(c, C) \right) \mid c \in C \right\}
$$
   여기서 $\text{count}(c, C)$는 좌표 $c$가 집합 $C$에서 등장하는 횟수를 의미한다.   중복 횟수가 한 번 또는  세 번 발생한 좌표들은 방의 경계를 결정하는 꼭지점이 된다. 발생 횟수에 따른 해석은 다음과 같다(그림 1 참조) . 
	- 1: 격자 끝에서 만나는 꼭지점.	
	- 3: 오목한 모양에서 발생하는 꼭지점.
	- 2, 4: 직선 경계에 위치한 비경계점 및 내부
	
**3. 중복 제거 및 다각형 꼭지점 집합 구성**
 한 번 또는 세 번 등장한 좌표만 남기고, 중복을 제거하여 다각형을 형성할 수 있는 꼭지점 집합  B를 생성한다. 이 집합은 다음과 같이 정의된다. $$B = \{ c \mid \text{count}(c, C) = 1 or 3\}
$$
이 단계에서는 아직 꼭지점을 연결하는 순서가 정해지지 않았기 때문에, 실제로 다각형을 형성하지는 않는다.

**4. 다각형 형성 순서 결정**

다각형을 형성하려면 꼭지점을 연결하는 순서를 결정해야 한다.  좌측 최상단에 위치한 꼭지점을 시작 점으로 선택한 뒤  수평과 수직 방향을 번갈아 가며 인접 좌표를 따라 확장해 나가며 경계선을 구성한다. 먼저 수평 방향으로 같은 x 좌표에 있는 가장 가까운 꼭지점을 선택한 후 수직 방향으로 같은 y 좌표에 있는 가장 가까운 좌표를 선택하여 다각형의 경계를 형성한다.  이를 반복하여 방의 외곽을 따라  다각형을 완성한다.

]]![[Pasted image 20240913175923.png]]


### 4.3.4 Rectangularity (직사각형성)

직사각형성(Rectangularity)은 다각형의 면적(Area)과 바운딩 박스(Bounding Box, 이하 BB)의 면적 사이 비율로 정의된다. 직사각형성은 다각형이 얼마나 직사각형에 가까운지를 평가하기 위한 지표로 사용되며, 다음 식으로 표현된다:

$$
R = \frac{A_{\text{polygon}}}{A_{\text{BB}}}
$$

여기서 $A_{\text{polygon}}$은 다각형의 면적을, $A_{\text{BB}}$는 해당 다각형을 포함하는 최소 바운딩 박스의 면적을 나타낸다.

#### 4.3.5 Regularity (정규성)

정규성(Regularity)은 다각형의 직사각형성과 바운딩 박스의 종횡비(Aspect Ratio)를 결합하여 다각형의 규칙성을 평가한다.

$$
Reg = R \times AR_{\text{BB}}
$$

여기서 $R$은 직사각형성, $AR_{\text{BB}}$는 바운딩 박스의 가로 길이와 세로 길이의 비율로 정의된다. 
### 4.3.6 Perimeter-Area Ratio (둘레-면적 비율)

둘레-면적 비율은 다각형의 압축성을 평가하는 지표로, 면적과 둘레의 비율을 다음 식으로 계산한다. 

$$
PA_{\text{ratio}} = \frac{16 \times A_{\text{polygon}}}{P_{\text{polygon}}^2}
$$

여기서 $A_{\text{polygon}}$은 다각형의 면적을, $P_{\text{polygon}}$은 다각형의 둘레 길이를 나타낸다.

### 4.3.7 Simplicity (단순성)

단순성(Simplicity)은 다각형의 꼭짓점 개수를 기반으로 계산되며, 다각형이 얼마나 단순한지를 평가하는 지표이다. 

$$
S = \frac{4}{V}
\quad \text{if} \quad V \geq 4 \quad \text{else} \quad 1.0
$$

여기서 $V$는 꼭짓점의 개수이다. 

### **4.3 공간의 형태에 따른 평가 방법**

개별 공간의 기하학적 형상 평가를 위해 네 가지 주요 적합도 메트릭을 사용하였다. 이를 위해 격자 기반의 방 배치를 다각형(Polygon) 구조로 변환하는 과정을 설명한다.

### **4.3.1 격자 공간을 다각형으로 변환**

각 방의 형상 평가를 위해서는 2D 격자 기반 평면보다는 다각형 구조가 유리하다. 격자 셀의 집합 구조보다는 방의 외곽선을 정의하는 꼭지점 좌표를 이용하여 기하학적 특성을 정밀하게 평가할 수 있기 때문이다. 다각형 기반의 형상 정보는 직사각형성, 정규성, 단순성 등을 측정하는 데 유용하며, 이를 통해 정량적 평가가 가능해진다. 또한, 다각형 구조는 건축 모델로 변환되어 배치도를 시각적으로 표현하거나, 세밀한 조정이 가능하게 한다.

다음은 격자 기반 공간을 다각형 구조로 변환하는 과정을 설명한다.

#### **1. 셀 꼭지점 좌표 집합 생성**

각 방을 구성하는 모든 격자 셀에 대해 네 개의 꼭지점 좌표 집합을 생성한다. 이를 통해 방을 구성하는 전체 좌표 집합 $C$를 정의할 수 있다. 각 셀 $r_i$의 네 꼭지점 좌표는 다음과 같다:
$$
\text{Corners}(r_i) = \left\{ (x_i, y_i), (x_i, y_i + 1), (x_i + 1, y_i + 1), (x_i + 1, y_i) \right\}
$$
따라서 전체 좌표 집합 $C$는 각 셀 $r_i$의 꼭지점 좌표들의 합집합으로 정의된다:
$$
C = \bigcup_{i=1}^{k} \text{Corners}(r_i)
$$

#### **2. 중복 횟수 카운팅 및 경계 결정**

각 좌표의 중복 횟수를 카운팅하여 좌표와 그 중복 횟수의 쌍으로 이루어진 집합 $Q$를 생성한다:
$$
Q = \left\{ \left( c, \text{count}(c, C) \right) \mid c \in C \right\}
$$
여기서 $\text{count}(c, C)$는 좌표 $c$가 집합 $C$ 내에서 등장한 횟수를 나타낸다. 중복 횟수가 한 번 또는 세 번 발생한 좌표는 경계를 나타내는 꼭지점으로 판단된다. 발생 횟수에 따른 해석은 다음과 같다:
- 1: 외부 경계에 해당하는 꼭지점
- 3: 오목한 부분에 위치한 꼭지점
- 2, 4: 내부 또는 직선 경계에 위치한 비경계점

#### **3. 중복 제거 및 다각형 꼭지점 집합 구성**

한 번 또는 세 번 등장한 좌표만을 남기고, 중복을 제거하여 다각형을 형성할 수 있는 꼭지점 집합 $B$를 구성한다:
$$
B = \left\{ c \mid \text{count}(c, C) = 1 \text{ 또는 } 3 \right\}
$$
이 단계에서는 아직 좌표들을 연결하는 순서가 정해지지 않았기 때문에, 실제로 다각형을 형성하지는 않는다.

#### **4. 다각형 형성 순서 결정**

다각형을 형성하려면 좌표를 연결하는 순서를 결정해야 한다. 좌측 최상단에 위치한 꼭지점을 시작점으로 선택한 뒤, 수평과 수직 방향을 번갈아 가며 인접 좌표를 따라 확장해 나가며 경계선을 구성한다. 먼저 수평 방향으로 같은 $x$ 좌표에 있는 가장 가까운 좌표를 선택한 후, 수직 방향으로 같은 $y$ 좌표에 있는 좌표를 선택하는 방식으로 경계를 형성한다. 이를 반복하여 방의 외곽선을 따라 다각형을 완성한다.

---

### **4.3.4 직사각형성(Rectangularity)**

직사각형성(Rectangularity)은 다각형의 면적(Area)과 최소 바운딩 박스(Bounding Box, 이하 BB)의 면적 비율로 정의된다. 직사각형성은 다각형이 직사각형에 얼마나 가까운지를 평가하는 지표로 사용되며, 다음과 같이 표현된다:
$$
R = \frac{A_{\text{polygon}}}{A_{\text{BB}}}
$$
여기서 $A_{\text{polygon}}$은 다각형의 면적을, $A_{\text{BB}}$는 해당 다각형을 포함하는 최소 바운딩 박스의 면적을 나타낸다.

#### **4.3.5 정규성(Regularity)**

정규성(Regularity)은 다각형의 직사각형성과 바운딩 박스의 종횡비(Aspect Ratio)를 결합하여 규칙성을 평가하는 지표이다:
$$
Reg = R \times AR_{\text{BB}}
$$
여기서 $R$은 직사각형성, $AR_{\text{BB}}$는 바운딩 박스의 가로 길이와 세로 길이의 비율로 정의된다.

#### **4.3.6 둘레-면적 비율(Perimeter-Area Ratio)**

둘레-면적 비율은 다각형의 압축성을 평가하는 지표로, 면적과 둘레의 비율을 통해 계산된다:
$$
PA_{\text{ratio}} = \frac{16 \times A_{\text{polygon}}}{P_{\text{polygon}}^2}
$$
여기서 $A_{\text{polygon}}$은 다각형의 면적, $P_{\text{polygon}}$은 둘레 길이를 나타낸다.

#### **4.3.7 단순성(Simplicity)**

단순성(Simplicity)은 다각형의 꼭짓점 수를 기반으로, 다각형이 얼마나 단순한지를 평가한다:
$$
S = \frac{4}{V}
\quad \text{if} \quad V \geq 4 \quad \text{else} \quad 1.0
$$
여기서 $V$는 꼭짓점의 개수이다.

---

$$ 
\text{ScoreSz}_i =
\begin{cases}
1, & A_{\text{min}} \leq A_{\text{actual}} \leq A_{\text{max}} \\
\frac{A_{\text{actual}}}{A_{\text{min}}}, & A_{\text{actual}} < A_{\text{min}} \\
\frac{A_{\text{max}}}{A_{\text{actual}}}, & A_{\text{actual}} > A_{\text{max}}
\end{cases}
$$
가독성 향상에 대한 언급은 주로 **수식 설명 부분**에서 발생할 수 있는 문제를 지적한 것입니다. 복잡한 수식을 설명하는 문장에서, 수식과 그에 대한 설명이 명확히 구분되지 않으면 독자가 내용을 이해하기 어려울 수 있습니다. 다음으로, 논문에서 가독성을 향상할 수 있는 구체적인 부분과 이를 어떻게 수정하면 좋을지 예시를 통해 설명하겠습니다.

### 예시: **면적 만족도**와 관련된 수식 설명

#### 원본 설명 (추정):
면적 만족 점수는 각 방의 면적이 주어진 최소 및 최대 요구 사항을 충족하는지의 점수로 평가된다. 실제 면적이 요구 범위 내에 있을 때 적합도 점수는 1로 부여되며, 범위를 벗어날 경우, 최솟값보다 작을 때와 클 때를 다음과 같이 계산한다.

\[
\text{ScoreSz}_i =
\begin{cases}
1, & A_{\text{min}} \leq A_{\text{actual}} \leq A_{\text{max}} \\
\frac{A_{\text{actual}}}{A_{\text{min}}}, & A_{\text{actual}} < A_{\text{min}} \\
\frac{A_{\text{max}}}{A_{\text{actual}}}, & A_{\text{actual}} > A_{\text{max}}
\end{cases}
\]
여기서 (1)은 면적이 요구 범위 내에 있을 때, (2)는 면적이 최솟값보다 작을 때, (3)은 면적이 최댓값보다 클 때이다. 전체 면적 만족도는 각 방의 평균으로 계산된다.

#### 문제점:
1. **수식 설명이 너무 압축적으로** 되어 있어, 독자가 수식이 의미하는 바를 파악하기 어렵다.
2. **수식과 설명의 구분이 모호**하여, 어떤 조건이 어떤 상황을 설명하는지 명확하지 않다.
3. **구체적인 예시나 설명 부족**으로 인해, 각 조건이 무엇을 의미하는지 쉽게 이해되지 않는다.

### 수정 및 보완 제안:

#### 수정된 설명:
면적 만족도는 각 방의 실제 면적이 사용자가 요구한 최소 및 최대 면적 범위 내에 있는지 여부에 따라 결정된다. 각 방의 면적 만족도 \( \text{ScoreSz}_i \)는 다음과 같은 세 가지 조건에 의해 계산된다:

1. **면적이 요구 범위 내에 있을 때**: 
   방 \( i \)의 실제 면적 \( A_{\text{actual}} \)이 최소 면적 \( A_{\text{min}} \)과 최대 면적 \( A_{\text{max}} \) 사이에 있을 경우, 이 방은 요구를 충족한 것으로 간주되어 만족도 점수 \( \text{ScoreSz}_i = 1 \)로 부여된다.
   
2. **면적이 최소 요구 면적보다 작을 때**: 
   실제 면적이 최소 요구 면적보다 작다면, 만족도 점수는 실제 면적과 최소 면적의 비율로 계산된다. 이때 점수는 \( \frac{A_{\text{actual}}}{A_{\text{min}}} \)로 감소하게 된다. 예를 들어, \( A_{\text{actual}} = 0.8 A_{\text{min}} \)일 경우, 면적 만족도는 0.8이 된다.

3. **면적이 최대 요구 면적보다 클 때**: 
   실제 면적이 최대 요구 면적을 초과할 경우, 만족도 점수는 최대 면적과 실제 면적의 비율로 계산되며, \( \frac{A_{\text{max}}}{A_{\text{actual}}} \)로 감소하게 된다. 예를 들어, \( A_{\text{actual}} = 1.2 A_{\text{max}} \)일 경우, 면적 만족도는 0.83이 된다.

이 세 조건을 종합하여, 면적 만족도 \( \text{ScoreSz}_i \)는 다음과 같은 방식으로 계산된다:

\[
\text{ScoreSz}_i =
\begin{cases}
1, & A_{\text{min}} \leq A_{\text{actual}} \leq A_{\text{max}} \\
\frac{A_{\text{actual}}}{A_{\text{min}}}, & A_{\text{actual}} < A_{\text{min}} \\
\frac{A_{\text{max}}}{A_{\text{actual}}}, & A_{\text{actual}} > A_{\text{max}}
\end{cases}
\]

전체 면적 만족도는 방 전체의 면적 만족도 점수의 평균으로 계산되며, 다음과 같은 식으로 표현된다:

\[
\text{Size Satisfaction} = \frac{1}{n} \sum_{i=1}^{n} \text{ScoreSz}_i
\]

여기서 \( n \)은 평가된 방의 총 개수를 의미한다.

### 보완 설명의 장점:
1. **수식 설명의 단계적 전개**: 각 조건을 구체적으로 나누어 설명하여, 수식에서 각각의 상황이 무엇을 의미하는지 명확히 전달.
2. **구체적인 예시 제공**: \( A_{\text{actual}} \)이 최소 또는 최대 범위를 벗어난 상황에서 계산되는 점수를 예시를 통해 설명함으로써, 독자가 수식을 직관적으로 이해할 수 있도록 돕는다.
3. **수식과 설명의 명확한 구분**: 수식이 나오기 전에 설명을 충분히 제공한 후, 수식을 제시하여 독자가 설명을 먼저 이해한 상태에서 수식을 확인할 수 있도록 구성.

### 결론:
복잡한 수식을 설명할 때는, 수식에 사용된 기호와 각 조건을 먼저 명확히 설명하고, 수식을 제시한 후 이를 보완하는 예시를 추가하는 것이 효과적입니다. 이를 통해 독자는 수식을 보다 쉽게 이해하고 논문의 내용을 빠르게 따라갈 수 있게 됩니다.